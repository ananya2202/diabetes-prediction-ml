<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Diabetes Predictor</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background:#f7f9fc; }
    .card { max-width: 720px; margin: 40px auto; }
    .result { font-size: 1.15rem; }
  </style>
</head>
<body>
  <div class="card shadow-sm">
    <div class="card-body">
      <h3 class="card-title mb-3">ü©∫ Diabetes Predictor</h3>
      <p class="text-muted">
        Enter the patient's clinical details and click <strong>Predict</strong>.
      </p>

      <!-- IMPORTANT: disable default submit -->
      <form id="predictForm" autocomplete="off" onsubmit="return false;">
        <div class="row g-2">

          <div class="col-md-6">
            <label class="form-label">Pregnancies:</label>
            <input id="Pregnancies" class="form-control" type="number" min="0" required>
          </div>

          <div class="col-md-6">
            <label class="form-label">Glucose:</label>
            <input id="Glucose" class="form-control" type="number" min="0" required>
          </div>

          <div class="col-md-6">
            <label class="form-label">Blood Pressure:</label>
            <input id="BloodPressure" class="form-control" type="number" min="0" required>
          </div>

          <div class="col-md-6">
            <label class="form-label">Skin Thickness:</label>
            <input id="SkinThickness" class="form-control" type="number" min="0" required>
          </div>

          <div class="col-md-6">
            <label class="form-label">Insulin:</label>
            <input id="Insulin" class="form-control" type="number" min="0" required>
          </div>

          <div class="col-md-6">
            <label class="form-label">BMI:</label>
            <input id="BMI" class="form-control" type="number" step="0.1" min="0" required>
          </div>

          <div class="col-md-6">
            <label class="form-label">Diabetes Pedigree Function:</label>
            <input id="DiabetesPedigreeFunction" class="form-control" type="number" step="0.001" min="0" required>
          </div>

          <div class="col-md-6">
            <label class="form-label">Age:</label>
            <input id="Age" class="form-control" type="number" min="0" required>
          </div>
        </div>

        <div class="mt-3 d-flex gap-2">
          <!-- type=button is CRITICAL -->
          <button type="button" id="btnPredict" class="btn btn-primary">Predict</button>
          <button type="button" id="btnReset" class="btn btn-outline-secondary">Reset</button>
          <div id="loading" class="ms-auto text-muted" style="display:none">‚è≥ Predicting...</div>
        </div>
      </form>

      <hr>

      <div id="output" class="result"></div>
      <div id="rawResponse" class="d-none"></div>

    </div>
  </div>

  <script>
    const output = document.getElementById('output');
    const rawResponse = document.getElementById('rawResponse');
    const loading = document.getElementById('loading');

    document.getElementById("btnPredict").addEventListener("click", async () => {
      output.innerHTML = '';
      rawResponse.innerText = '';
      loading.style.display = 'inline';

      const payload = {
        Pregnancies: Number(document.getElementById("Pregnancies").value),
        Glucose: Number(document.getElementById("Glucose").value),
        BloodPressure: Number(document.getElementById("BloodPressure").value),
        SkinThickness: Number(document.getElementById("SkinThickness").value),
        Insulin: Number(document.getElementById("Insulin").value),
        BMI: Number(document.getElementById("BMI").value),
        DiabetesPedigreeFunction: Number(document.getElementById("DiabetesPedigreeFunction").value),
        Age: Number(document.getElementById("Age").value)
      };

      try {
        const res = await fetch("/predict", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        const data = await res.json();

        output.innerHTML =
          data.prediction === "Diabetic"
            ? `<div class="alert alert-danger">
                 ‚ö† Prediction: <strong>Diabetic</strong><br>
                 <small class="text-muted">Model used: ${data.model_used}</small>
               </div>`
            : `<div class="alert alert-success">
                 ‚úî Prediction: <strong>Not Diabetic</strong><br>
                 <small class="text-muted">Model used: ${data.model_used}</small>
               </div>`;

        rawResponse.innerText = JSON.stringify(data);

      } catch (err) {
        output.innerHTML = `<div class="alert alert-danger">Error: ${err.message}</div>`;
      } finally {
        loading.style.display = 'none';
      }
    });

    document.getElementById('btnReset').addEventListener('click', () => {
      document.getElementById('predictForm').reset();
      output.innerHTML = '';
      rawResponse.innerText = '';
    });
  </script>
</body>
</html>
